<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TP JavaScript Avancé</title>
    <style>
      :root {
        --primary: #3498db;
        --secondary: #2ecc71;
        --accent: #e74c3c;
        --dark: #2c3e50;
        --light: #ecf0f1;
        --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background-color: #f5f7fa;
        color: var(--dark);
        line-height: 1.6;
      }

      header {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        text-align: center;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
      }

      h1 {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .part {
        background: white;
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
      }

      h2 {
        color: var(--primary);
        border-bottom: 2px solid var(--light);
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
      }

      h3 {
        color: var(--secondary);
        margin: 1rem 0 0.5rem;
      }

      .exercise {
        background-color: var(--light);
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }

      .code-block {
        background-color: #2d3a4b;
        color: #abb2bf;
        padding: 1rem;
        border-radius: 5px;
        margin: 1rem 0;
        overflow-x: auto;
        font-family: "Fira Code", monospace;
      }

      .btn {
        background-color: var(--primary);
        color: white;
        border: none;
        padding: 0.7rem 1.5rem;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color 0.3s;
        margin: 0.5rem 0;
      }

      .btn:hover {
        background-color: #2980b9;
      }

      .result {
        background-color: #f8f9fa;
        padding: 1rem;
        border-left: 4px solid var(--secondary);
        margin: 1rem 0;
        border-radius: 0 5px 5px 0;
      }

      .student-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
        margin: 1rem 0;
      }

      .student-card {
        background: white;
        padding: 1rem;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .post-list {
        list-style-type: none;
      }

      .post-item {
        background: white;
        padding: 1rem;
        margin: 0.5rem 0;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      }

      footer {
        text-align: center;
        padding: 2rem;
        margin-top: 2rem;
        background-color: var(--dark);
        color: white;
      }

      @media (max-width: 768px) {
        .student-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>TP JavaScript Avancé</h1>
      <p>Révision de la syntaxe moderne (ES6+) et concepts avancés</p>
    </header>

    <div class="container">
      <section class="part">
        <h2>Partie 1 – Rappel et Syntaxe moderne (45 min)</h2>

        <div class="exercise">
          <h3>Exercice 1 – Variables et portée</h3>
          <div class="code-block">
            // Démonstration des différences de portée<br />
            console.log("Avant le bloc:", varVariable); // undefined
            (hoisting)<br />
            <br />
            {<br />
            &nbsp;&nbsp;var varVariable = "Je suis une var";<br />
            &nbsp;&nbsp;let letVariable = "Je suis une let";<br />
            &nbsp;&nbsp;const constVariable = "Je suis une const";<br />
            &nbsp;&nbsp;console.log("Dans le bloc:", varVariable, letVariable,
            constVariable);<br />
            }<br />
            <br />
            console.log("Après le bloc:", varVariable); // Accessible<br />
            // console.log(letVariable); // Erreur: not defined<br />
            // console.log(constVariable); // Erreur: not defined<br />
            <br />
            // const ne peut pas être réaffectée<br />
            const pi = 3.14;<br />
            // pi = 3.14159; // Erreur: Assignment to constant variable
          </div>
          <button class="btn" onclick="runEx1()">Exécuter l'exercice 1</button>
          <div class="result" id="ex1-result"></div>
        </div>

        <div class="exercise">
          <h3>Exercice 2 – Fonctions fléchées</h3>
          <div class="code-block">
            // Fonction classique<br />
            function somme(a, b) {<br />
            &nbsp;&nbsp;return a + b;<br />
            }<br />
            <br />
            // Fonction fléchée avec return explicite<br />
            const sommeFlechee = (a, b) => {<br />
            &nbsp;&nbsp;return a + b;<br />
            };<br />
            <br />
            // Fonction fléchée avec return implicite<br />
            const sommeImplicite = (a, b) => a + b;<br />
            <br />
            console.log("Somme classique:", somme(5, 3));<br />
            console.log("Somme fléchée:", sommeFlechee(5, 3));<br />
            console.log("Somme implicite:", sommeImplicite(5, 3));
          </div>
          <button class="btn" onclick="runEx2()">Exécuter l'exercice 2</button>
          <div class="result" id="ex2-result"></div>
        </div>

        <div class="exercise">
          <h3>Exercice 3 – Destructuring</h3>
          <div class="code-block">
            const user = { name: "Noor", age: 10, city: "Tunis" };<br />
            <br />
            // Extraction avec destructuring<br />
            const { name, age } = user;<br />
            <br />
            console.log("Nom:", name);<br />
            console.log("Âge:", age);<br />
            // La variable city n'est pas extraite<br />
            // console.log(city); // Erreur: city is not defined
          </div>
          <button class="btn" onclick="runEx3()">Exécuter l'exercice 3</button>
          <div class="result" id="ex3-result"></div>
        </div>

        <div class="exercise">
          <h3>Exercice 4 – Spread Operator</h3>
          <div class="code-block">
            // Fusion de tableaux<br />
            const arr1 = [1, 2, 3];<br />
            const arr2 = [4, 5, 6];<br />
            const fusion = [...arr1, ...arr2];<br />
            console.log("Fusion de tableaux:", fusion);<br />
            <br />
            // Copie d'objet et modification<br />
            const original = { a: 1, b: 2, c: 3 };<br />
            const copie = { ...original, b: 20 };<br />
            console.log("Original:", original);<br />
            console.log("Copie modifiée:", copie);
          </div>
          <button class="btn" onclick="runEx4()">Exécuter l'exercice 4</button>
          <div class="result" id="ex4-result"></div>
        </div>
      </section>

      <section class="part">
        <h2>Partie 2 – Objets, Classes, Tableaux (45 min)</h2>

        <div class="exercise">
          <h3>Exercice 5 – Objet simple</h3>
          <div class="code-block">
            // Création d'un objet livre<br />
            const livre = {<br />
            &nbsp;&nbsp;titre: "JavaScript: The Good Parts",<br />
            &nbsp;&nbsp;auteur: "Douglas Crockford",<br />
            &nbsp;&nbsp;annee: 2008,<br />
            &nbsp;&nbsp;getInfo: function() {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;return `${this.titre} par ${this.auteur}
            (${this.annee})`;<br />
            &nbsp;&nbsp;}<br />
            };<br />
            <br />
            console.log(livre.getInfo());
          </div>
          <button class="btn" onclick="runEx5()">Exécuter l'exercice 5</button>
          <div class="result" id="ex5-result"></div>
        </div>

        <div class="exercise">
          <h3>Exercice 6 – Classe ES6</h3>
          <div class="code-block">
            class Etudiant {<br />
            &nbsp;&nbsp;constructor(nom, note) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;this.nom = nom;<br />
            &nbsp;&nbsp;&nbsp;&nbsp;this.note = note;<br />
            &nbsp;&nbsp;}<br />
            <br />
            &nbsp;&nbsp;getMention() {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;if (this.note >= 16) return "Très bien";<br />
            &nbsp;&nbsp;&nbsp;&nbsp;if (this.note >= 14) return "Bien";<br />
            &nbsp;&nbsp;&nbsp;&nbsp;if (this.note >= 10) return "Passable";<br />
            &nbsp;&nbsp;&nbsp;&nbsp;return "Échec";<br />
            &nbsp;&nbsp;}<br />
            }<br />
            <br />
            // Création de 3 étudiants<br />
            const etudiants = [<br />
            &nbsp;&nbsp;new Etudiant("Alice", 18),<br />
            &nbsp;&nbsp;new Etudiant("Bob", 12),<br />
            &nbsp;&nbsp;new Etudiant("Charlie", 9)<br />
            ];<br />
            <br />
            // Affichage des mentions<br />
            etudiants.forEach(etudiant => {<br />
            &nbsp;&nbsp;console.log(`${etudiant.nom}: ${etudiant.note} -
            ${etudiant.getMention()}`);<br />
            });
          </div>
          <button class="btn" onclick="runEx6()">Exécuter l'exercice 6</button>
          <div class="result" id="ex6-result"></div>
        </div>

        <div class="exercise">
          <h3>Exercice 7 – Tableaux avancés</h3>
          <div class="code-block">
            const notes = [12, 5, 17, 9, 20];<br />
            <br />
            // 1. Calcul de la moyenne avec reduce<br />
            const moyenne = notes.reduce((acc, note) => acc + note, 0) /
            notes.length;<br />
            console.log("Moyenne:", moyenne.toFixed(2));<br />
            <br />
            // 2. Tri en ordre décroissant<br />
            const notesTriées = [...notes].sort((a, b) => b - a);<br />
            console.log("Notes triées:", notesTriées);<br />
            <br />
            // 3. Filtrage des notes ≥10<br />
            const notesSup10 = notes.filter(note => note >= 10);<br />
            console.log("Notes ≥10:", notesSup10);
          </div>
          <button class="btn" onclick="runEx7()">Exécuter l'exercice 7</button>
          <div class="result" id="ex7-result"></div>
        </div>
      </section>

      <section class="part">
        <h2>Partie 3 – Asynchronisme et API (1h)</h2>

        <div class="exercise">
          <h3>Exercice 8 – Promesse simple</h3>
          <div class="code-block">
            const wait = ms => new Promise(res => setTimeout(res, ms));<br />
            <br />
            async function simulationTelechargement() {<br />
            &nbsp;&nbsp;console.log("Début du téléchargement...");<br />
            &nbsp;&nbsp;await wait(2000); // Attente de 2 secondes<br />
            &nbsp;&nbsp;console.log("Téléchargement terminé!");<br />
            }<br />
            <br />
            simulationTelechargement();
          </div>
          <button class="btn" onclick="runEx8()">Exécuter l'exercice 8</button>
          <div class="result" id="ex8-result"></div>
        </div>

        <div class="exercise">
          <h3>Exercice 9 – Fetch + async/await</h3>
          <div class="code-block">
            async function fetchPosts() {<br />
            &nbsp;&nbsp;try {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;const response = await
            fetch('https://jsonplaceholder.typicode.com/posts');<br />
            &nbsp;&nbsp;&nbsp;&nbsp;const posts = await response.json();<br />
            &nbsp;&nbsp;&nbsp;&nbsp;return posts.slice(0, 5); // Retourne les 5
            premiers posts<br />
            &nbsp;&nbsp;} catch (error) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;console.error("Erreur lors de la
            récupération des posts:", error);<br />
            &nbsp;&nbsp;}<br />
            }<br />
            <br />
            // Affichage des titres<br />
            fetchPosts().then(posts => {<br />
            &nbsp;&nbsp;if (posts) {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;posts.forEach(post => {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(post.title);<br />
            &nbsp;&nbsp;&nbsp;&nbsp;});<br />
            &nbsp;&nbsp;}<br />
            });
          </div>
          <button class="btn" onclick="runEx9()">Exécuter l'exercice 9</button>
          <div class="result" id="ex9-result"></div>
        </div>
      </section>
    </div>

    <footer>
      <p>TP JavaScript Avancé - Réalisation complète avec ES6+</p>
    </footer>

    <script>
      // Exercice 1 - Variables et portée
      function runEx1() {
        const resultDiv = document.getElementById("ex1-result");
        resultDiv.innerHTML =
          "<strong>Résultats dans la console</strong><br>Ouvrez la console du navigateur (F12) pour voir les résultats.";

        console.log("=== Exercice 1 - Variables et portée ===");

        console.log(
          "Avant le bloc: varVariable =",
          typeof varVariable !== "undefined"
            ? varVariable
            : "undefined (hoisting)"
        );

        {
          var varVariable = "Je suis une var";
          let letVariable = "Je suis une let";
          const constVariable = "Je suis une const";
          console.log("Dans le bloc:", varVariable, letVariable, constVariable);
        }

        console.log("Après le bloc: varVariable =", varVariable);
        // Les lignes suivantes généreraient des erreurs, donc on les commente
        // console.log(letVariable); // Erreur: not defined
        // console.log(constVariable); // Erreur: not defined

        // Démonstration avec const
        const pi = 3.14;
        console.log("Valeur de pi:", pi);
        // pi = 3.14159; // Cette ligne générerait une erreur
        console.log(
          "const ne peut pas être réaffectée - Essayez de décommenter la ligne pi = 3.14159 pour voir l'erreur"
        );
      }

      // Exercice 2 - Fonctions fléchées
      function runEx2() {
        const resultDiv = document.getElementById("ex2-result");

        // Fonction classique
        function somme(a, b) {
          return a + b;
        }

        // Fonction fléchée avec return explicite
        const sommeFlechee = (a, b) => {
          return a + b;
        };

        // Fonction fléchée avec return implicite
        const sommeImplicite = (a, b) => a + b;

        const result1 = somme(5, 3);
        const result2 = sommeFlechee(5, 3);
        const result3 = sommeImplicite(5, 3);

        resultDiv.innerHTML = `
                <strong>Résultats:</strong><br>
                Somme classique: 5 + 3 = ${result1}<br>
                Somme fléchée: 5 + 3 = ${result2}<br>
                Somme implicite: 5 + 3 = ${result3}
            `;

        console.log("=== Exercice 2 - Fonctions fléchées ===");
        console.log("Somme classique:", result1);
        console.log("Somme fléchée:", result2);
        console.log("Somme implicite:", result3);
      }

      // Exercice 3 - Destructuring
      function runEx3() {
        const resultDiv = document.getElementById("ex3-result");

        const user = { name: "Noor", age: 10, city: "Tunis" };

        // Extraction avec destructuring
        const { name, age } = user;

        resultDiv.innerHTML = `
                <strong>Résultats:</strong><br>
                Nom: ${name}<br>
                Âge: ${age}<br>
                <em>Note: La propriété 'city' n'a pas été extraite et n'est pas accessible</em>
            `;

        console.log("=== Exercice 3 - Destructuring ===");
        console.log("Nom:", name);
        console.log("Âge:", age);
      }

      // Exercice 4 - Spread Operator
      function runEx4() {
        const resultDiv = document.getElementById("ex4-result");

        // Fusion de tableaux
        const arr1 = [1, 2, 3];
        const arr2 = [4, 5, 6];
        const fusion = [...arr1, ...arr2];

        // Copie d'objet et modification
        const original = { a: 1, b: 2, c: 3 };
        const copie = { ...original, b: 20 };

        resultDiv.innerHTML = `
                <strong>Résultats:</strong><br>
                <strong>Fusion de tableaux:</strong> [${arr1}] + [${arr2}] = [${fusion}]<br>
                <strong>Original:</strong> ${JSON.stringify(original)}<br>
                <strong>Copie modifiée:</strong> ${JSON.stringify(copie)}
            `;

        console.log("=== Exercice 4 - Spread Operator ===");
        console.log("Fusion de tableaux:", fusion);
        console.log("Original:", original);
        console.log("Copie modifiée:", copie);
      }

      // Exercice 5 - Objet simple
      function runEx5() {
        const resultDiv = document.getElementById("ex5-result");

        // Création d'un objet livre
        const livre = {
          titre: "JavaScript: The Good Parts",
          auteur: "Douglas Crockford",
          annee: 2008,
          getInfo: function () {
            return `${this.titre} par ${this.auteur} (${this.annee})`;
          },
        };

        const info = livre.getInfo();
        resultDiv.innerHTML = `<strong>Résultat:</strong> ${info}`;

        console.log("=== Exercice 5 - Objet simple ===");
        console.log(info);
      }

      // Exercice 6 - Classe ES6
      function runEx6() {
        const resultDiv = document.getElementById("ex6-result");

        class Etudiant {
          constructor(nom, note) {
            this.nom = nom;
            this.note = note;
          }

          getMention() {
            if (this.note >= 16) return "Très bien";
            if (this.note >= 14) return "Bien";
            if (this.note >= 10) return "Passable";
            return "Échec";
          }
        }

        // Création de 3 étudiants
        const etudiants = [
          new Etudiant("Alice", 18),
          new Etudiant("Bob", 12),
          new Etudiant("Charlie", 9),
        ];

        // Construction du HTML pour l'affichage
        let html =
          '<strong>Liste des étudiants:</strong><div class="student-grid">';
        etudiants.forEach((etudiant) => {
          html += `
                    <div class="student-card">
                        <strong>${etudiant.nom}</strong><br>
                        Note: ${etudiant.note}<br>
                        Mention: ${etudiant.getMention()}
                    </div>
                `;
        });
        html += "</div>";

        resultDiv.innerHTML = html;

        console.log("=== Exercice 6 - Classe ES6 ===");
        etudiants.forEach((etudiant) => {
          console.log(
            `${etudiant.nom}: ${etudiant.note} - ${etudiant.getMention()}`
          );
        });
      }

      // Exercice 7 - Tableaux avancés
      function runEx7() {
        const resultDiv = document.getElementById("ex7-result");

        const notes = [12, 5, 17, 9, 20];

        // 1. Calcul de la moyenne avec reduce
        const moyenne =
          notes.reduce((acc, note) => acc + note, 0) / notes.length;

        // 2. Tri en ordre décroissant
        const notesTriées = [...notes].sort((a, b) => b - a);

        // 3. Filtrage des notes ≥10
        const notesSup10 = notes.filter((note) => note >= 10);

        resultDiv.innerHTML = `
                <strong>Résultats:</strong><br>
                <strong>Notes originales:</strong> [${notes.join(", ")}]<br>
                <strong>Moyenne:</strong> ${moyenne.toFixed(2)}<br>
                <strong>Notes triées (décroissant):</strong> [${notesTriées.join(
                  ", "
                )}]<br>
                <strong>Notes ≥10:</strong> [${notesSup10.join(", ")}]
            `;

        console.log("=== Exercice 7 - Tableaux avancés ===");
        console.log("Notes originales:", notes);
        console.log("Moyenne:", moyenne.toFixed(2));
        console.log("Notes triées:", notesTriées);
        console.log("Notes ≥10:", notesSup10);
      }

      // Exercice 8 - Promesse simple
      function runEx8() {
        const resultDiv = document.getElementById("ex8-result");

        resultDiv.innerHTML =
          "<strong>Simulation en cours...</strong> (voir la console dans 2 secondes)";

        const wait = (ms) => new Promise((res) => setTimeout(res, ms));

        async function simulationTelechargement() {
          console.log("=== Exercice 8 - Promesse simple ===");
          console.log("Début du téléchargement...");
          resultDiv.innerHTML += "<br>Début du téléchargement...";

          await wait(2000); // Attente de 2 secondes

          console.log("Téléchargement terminé!");
          resultDiv.innerHTML += "<br>Téléchargement terminé!";
        }

        simulationTelechargement();
      }

      // Exercice 9 - Fetch + async/await
      function runEx9() {
        const resultDiv = document.getElementById("ex9-result");

        resultDiv.innerHTML = "<strong>Chargement des posts...</strong>";

        async function fetchPosts() {
          try {
            console.log("=== Exercice 9 - Fetch + async/await ===");
            const response = await fetch(
              "https://jsonplaceholder.typicode.com/posts"
            );
            const posts = await response.json();
            return posts.slice(0, 5); // Retourne les 5 premiers posts
          } catch (error) {
            console.error("Erreur lors de la récupération des posts:", error);
            resultDiv.innerHTML +=
              "<br>Erreur lors de la récupération des posts";
          }
        }

        // Affichage des titres
        fetchPosts().then((posts) => {
          if (posts) {
            let html =
              "<strong>5 premiers posts:</strong><ul class='post-list'>";
            posts.forEach((post) => {
              html += `<li class="post-item"><strong>${
                post.title
              }</strong><br>${post.body.substring(0, 50)}...</li>`;
              console.log(post.title);
            });
            html += "</ul>";
            resultDiv.innerHTML = html;
          }
        });
      }
    </script>
  </body>
</html>
